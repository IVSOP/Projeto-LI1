<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Tarefa1_2021li1g025</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption empty">&nbsp;</p></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>Pedro Miguel Meruge Ferreira &lt;a100709@alunos.uminho.pt&gt;;<br />: Ivan S&#233;rgio Rocha Ribeiro &lt;a100538@alunos.uminho.pt&gt;;</td></tr><tr><th>Safe Haskell</th><td>Safe</td></tr></table><p class="caption">Tarefa1_2021li1g025</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Fun&#231;&#227;o principal</a></li><li><a href="#g:2">Fun&#231;&#245;es auxiliares</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>M&#243;dulo para a realiza&#231;&#227;o da Tarefa 1 do projeto de LI1 em 2021/22.</p><p>Para os exemplos, ser&#225; utilizado o seguinta mapa:</p><p><img src="example.png" /></p><p>Onde a porta &#233; representada a azul, os blocos a vermelho e as caixas a laranja</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:validaPotencialMapa">validaPotencialMapa</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Bool</li><li class="src short"><a href="#v:ordena">ordena</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]</li><li class="src short"><a href="#v:inserePeca">inserePeca</a> :: (<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>) -&gt; [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]</li><li class="src short"><a href="#v:yMax">yMax</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Int</li><li class="src short"><a href="#v:xMax">xMax</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Int</li><li class="src short"><a href="#v:contaPecas">contaPecas</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; (Int, Int, Int)</li><li class="src short"><a href="#v:getPeca">getPeca</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]</li><li class="src short"><a href="#v:getColuna">getColuna</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Int -&gt; ([(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)], [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)])</li><li class="src short"><a href="#v:getColunas">getColunas</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Int -&gt; [[(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]]</li><li class="src short"><a href="#v:getBase">getBase</a> :: [[(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]] -&gt; [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]</li><li class="src short"><a href="#v:validaPeca">validaPeca</a> :: (<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>) -&gt; [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Bool</li><li class="src short"><a href="#v:validaBase">validaBase</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; [[(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]] -&gt; Bool</li><li class="src short"><a href="#v:pecaSingular">pecaSingular</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Bool</li><li class="src short"><a href="#v:converSecond">converSecond</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>]</li><li class="src short"><a href="#v:validaCaixas">validaCaixas</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Bool</li></ul></details></div><div id="interface"><a href="#g:1" id="g:1"><h1>Fun&#231;&#227;o principal</h1></a><div class="top"><p class="src"><a id="v:validaPotencialMapa" class="def">validaPotencialMapa</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Bool <a href="#v:validaPotencialMapa" class="selflink">#</a></p><div class="doc"><p>Testa todos os crit&#233;rios, recebendo o mapa sob o nome &quot;pecas&quot;.</p><h4>Para tal, &#233; necess&#225;rio armazenar estes valores:</h4><ul><li><p>Ordenar o mapa</p><pre>mapa = ordena pecas</pre></li></ul><ul><li><p>Obter o maior valor de coluna e linha (x,y)</p><pre>xmax = xMax mapa
ymax = yMax mapa
</pre></li><li><p>Criar uma lista das colunas</p><pre>colunas = getColunas mapa xmax</pre></li><li><p>Obter a &quot;base&quot; do mapa (&#250;ltimos blocos de cada coluna)</p><pre>base = getBase colunas</pre></li><li><p>Obter o n&#250;mero de cada pe&#231;a (exceto do Vazio)</p><pre>(portas,blocos,caixas) = contaPecas mapa</pre></li></ul><h4>Com isto, podemos testar todos os crit&#233;rios</h4><p>Se algum destes for <strong>True</strong>, ent&#227;o o mapa <strong>n&#227;o</strong> &#233; v&#225;lido:</p><ul><li><p>N&#227;o haver mais que uma declara&#231;&#227;o de pe&#231;a para a mesma posi&#231;&#227;o</p><pre>not (pecaSingular mapa) </pre></li><li><p>Declarar exatamente uma porta</p><pre>portas /= 1</pre></li><li><p>Todas as caixas devem estar posicionadas em cima de outra caixa ou bloco</p><pre>not (validaCaixas mapa)</pre></li><li><p>Deve existir pelo menos um expa&#231;o vazio </p><p>N&#250;mero total de blocos /= n&#250;mero de casas totais no mapa</p><pre>(xmax+1)*(ymax+1) == (portas+blocos+caixas)</pre></li><li><p>A base do mapa deve ser composta por blocos</p><p>N&#227;o podem haver colunas sem blocos</p><pre>elem [] colunas</pre><p>Os blocos da base t&#234;m de ser &quot;v&#225;lidos&quot;</p><pre>not (validaBase base colunas)</pre></li></ul></div></div><a href="#g:2" id="g:2"><h1>Fun&#231;&#245;es auxiliares</h1></a><div class="top"><p class="src"><a id="v:ordena" class="def">ordena</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] <a href="#v:ordena" class="selflink">#</a></p><div class="doc"><p>Ordena o mapa segundo x e y crescente</p></div></div><div class="top"><p class="src"><a id="v:inserePeca" class="def">inserePeca</a> :: (<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>) -&gt; [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] <a href="#v:inserePeca" class="selflink">#</a></p><div class="doc"><p>Insere uma pe&#231;a numa lista (ordenada) de pe&#231;as</p></div></div><div class="top"><p class="src"><a id="v:yMax" class="def">yMax</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Int <a href="#v:yMax" class="selflink">#</a></p><div class="doc"><p>Devolve o y maximo do mapa</p></div></div><div class="top"><p class="src"><a id="v:xMax" class="def">xMax</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Int <a href="#v:xMax" class="selflink">#</a></p><div class="doc"><p>Devolve o x maximo do mapa</p></div></div><div class="top"><p class="src"><a id="v:contaPecas" class="def">contaPecas</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; (Int, Int, Int) <a href="#v:contaPecas" class="selflink">#</a></p><div class="doc"><p>Conta o numero de portas, caixas e blocos</p></div></div><div class="top"><p class="src"><a id="v:getPeca" class="def">getPeca</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a> -&gt; [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] <a href="#v:getPeca" class="selflink">#</a></p><div class="doc"><p>Devolve pecas dada as suas coordenadas. Devolve uma lista para que possamos verificar repeti&#231;&#245;es ou n&#227;o exist&#234;ncia de pe&#231;as</p></div></div><div class="top"><p class="src"><a id="v:getColuna" class="def">getColuna</a> <a href="#v:getColuna" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]</td><td class="doc"><p>Mapa</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>&#205;ndice da coluna (x)</p></td></tr><tr><td class="src">-&gt; ([(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)], [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)])</td><td class="doc"><p>(coluna,mapa sem coluna)</p></td></tr></table></div><div class="doc"><p>Devolve uma coluna de blocos e o mapa sem essa coluna, para maior efici&#234;ncia na fun&#231;&#227;o <code><a href="Tarefa1_2021li1g025.html#v:getColunas" title="Tarefa1_2021li1g025">getColunas</a></code></p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>getColuna mapa 1
</code></strong>([Bloco,(1,6)], [(Bloco,(0,0)),...(restante mapa))
</pre></div></div><div class="top"><p class="src"><a id="v:getColunas" class="def">getColunas</a> <a href="#v:getColunas" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]</td><td class="doc"><p>Mapa</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>Maior &#237;ndice de coluna (xmax)</p></td></tr><tr><td class="src">-&gt; [[(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]]</td><td class="doc"><p>Lista de colunas</p></td></tr></table></div><div class="doc"><p>Devolve uma lista de listas em que cada lista corresponde a uma coluna</p><p>As colunas ficam ordenadas segundo y crescente, mas segundo x decrescente</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>getColunas mapa 12
</code></strong>[[(Bloco,(12,0)),(Bloco,(12,1)),(Bloco,(12,2)),(Bloco,(12,3)),(Bloco,(12,4)),(Bloco,(12,5)),(Bloco,(12,6))],...,[(Bloco,(8,4)),(Bloco,(8,5)),(Bloco,(8,6))]...
</pre></div></div><div class="top"><p class="src"><a id="v:getBase" class="def">getBase</a> :: [[(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]] -&gt; [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] <a href="#v:getBase" class="selflink">#</a></p><div class="doc"><p>Devolve blocos mais &quot;baixos&quot; de cada coluna</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>getBase (getColunas mapa 12)
</code></strong>[(Bloco,(12,6)),(Bloco,(11,6)),(Bloco,(10,6)),(Bloco,(9,6)),(Bloco,(8,6)),(Bloco,(7,6)),(Bloco,(6,5)),(Bloco,(5,4)),...
</pre></div></div><div class="top"><p class="src"><a id="v:validaPeca" class="def">validaPeca</a> :: (<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>) -&gt; [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Bool <a href="#v:validaPeca" class="selflink">#</a></p><div class="doc"><p>Verifica se uma dada pe&#231;a est&#225; &quot;suportada&quot; por outra pe&#231;a numa coluna adjacente.</p><p>Para isso, sendo dada essa pe&#231;a e a coluna &#224; sua esquerda, testa se existem pe&#231;as adjacentes &#224; pe&#231;a</p></div></div><div class="top"><p class="src"><a id="v:validaBase" class="def">validaBase</a> <a href="#v:validaBase" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]</td><td class="doc"><p>Base do mapa</p></td></tr><tr><td class="src">-&gt; [[(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)]]</td><td class="doc"><p>Lista de colunas do mapa</p></td></tr><tr><td class="src">-&gt; Bool</td><td class="doc"><p>True se a base for v&#225;lida</p></td></tr></table></div><div class="doc"><p>Verifica se a base do mapa &#233; v&#225;lida
Estes esquemas ilustram como a fun&#231;&#227;o valida uma base:</p><p>Primeiro, &#233; dada a base do mapa como argumento</p><p><img src="map1.png" /> <img src="map2.png" /> <img src="map3.png" /></p><p><img src="map1.2.png" /> <img src="map2.2.png" /> <img src="map3.2.png" /></p><p>Depois, da direita para a esqueda, cada pe&#231;a da base &#233; validada, atrav&#233;s da <code><a href="Tarefa1_2021li1g025.html#v:validaPeca" title="Tarefa1_2021li1g025">validaPeca</a></code> que recebe essa peca e a coluna &#224; sua esquerda</p><p><img src="map1.3.png" /> <img src="map2.3.png" /> <img src="map3.3.png" /></p><p>No caso do primeiro mapa, a primeira pe&#231;a n&#227;o &#233; v&#225;lida.</p><p>Quando isto acontece, &#233; verificado se existe uma pe&#231;a acima</p><p><img src="map1.4.png" /></p><p>Se n&#227;o existir, a base n&#227;o &#233; v&#225;lida.</p><p>Neste caso, como existe, esta passa a ser a pe&#231;a que tem de ser validada</p><p><img src="map1.5.png" /></p><p>Este processo &#233; repetido recursivamente at&#233; percorrer toda a base ou chegar a um caso n&#227;o v&#225;lido.</p></div></div><div class="top"><p class="src"><a id="v:pecaSingular" class="def">pecaSingular</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Bool <a href="#v:pecaSingular" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que testa se existem declara&#231;&#245;es de pe&#231;as no mesmo s&#237;to
 assume-se que a lista n&#227;o &#233; vazia</p></div></div><div class="top"><p class="src"><a id="v:converSecond" class="def">converSecond</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; [<a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>] <a href="#v:converSecond" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:validaCaixas" class="def">validaCaixas</a> :: [(<a href="LI12122.html#t:Peca" title="LI12122">Peca</a>, <a href="LI12122.html#t:Coordenadas" title="LI12122">Coordenadas</a>)] -&gt; Bool <a href="#v:validaCaixas" class="selflink">#</a></p><div class="doc"><p>Verifica se todas as caixas do mapa t&#234;m um bloco ou uma caixa na posi&#231;&#227;o diretamente abaixo</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.22.0</p></div></body></html>